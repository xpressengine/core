<!--%load_js_plugin("jquery.fileupload")-->
<!--%load_js_plugin("jquery.finderSelect")-->
<!--%load_js_plugin("handlebars")-->
<load target="./lang" />
<div cond="$allow_fileupload" id="xefu-container-{$editor_sequence}" class="xefu-container xe-clearfix" data-editor-sequence="{$editor_sequence}">
	<!--// dropzone -->
	<div class="xefu-dropzone">
		<span class="xefu-btn fileinput-button xefu-act-selectfile">
			<span><i class="xi-icon xi-file-add"></i> {$lang->edit->upload_file}</span>
			<input id="xe-fileupload" type="file" class="fileupload-processing " value="{$lang->edit->upload_file}" name="Filedata" data-auto-upload="true" data-editor-sequence="{$editor_sequence}" multiple />
		</span>

		<p class="xefu-dropzone-message">{$lang->ckeditor_about_file_drop_area}</p>

		<p class="upload_info">{$lang->allowed_filesize} : <span class="allowed_filesize">0MB</span> <span>({$lang->allowed_filetypes} : <span class="allowed_filetypes">*.*</span>)</span></p>

		<p class="xefu-progress-status" style="display: none;">{$lang->ckeditor_file_uploading} (<span class="xefu-progress-percent">0%</span>)</p>
		<div class="xefu-progressbar" style="display: none;"><div></div></div>
	</div>
	<!--// END:dropzone -->

	<div class="xefu-controll xe-clearfix">
		<div style="float: left;">
			{$lang->ckeditor_file_count} (<span class="attached_size"></span> / <span class="allowed_attach_size"></span>)
		</div>

		<div style="float: right">
			<input type="button" class="xefu-btn xefu-act-link-selected" style=" vertical-align: middle; vertical-align: middle;" value="{$lang->edit->link_file}">
			<input type="button" class="xefu-btn xefu-act-delete-selected" style=" vertical-align: middle; vertical-align: middle;" value="{$lang->edit->delete_selected}">
		</div>
	</div>

	<div class="xefu-list">
		<div class="xefu-list-images">
			<ul>
			</ul>
		</div>

		<div class="xefu-list-files">
			<ul>
			</ul>
		</div>
	</div>

</div>

<script>
	jQuery(function($){
		// uploader
		<!--@if($allow_fileupload)-->
		window.xe.msg_exceeds_limit_size = '{$lang->msg_exceeds_limit_size}';
		window.xe.msg_checked_file_is_deleted = '{$lang->msg_checked_file_is_deleted}';
		window.xe.msg_file_cart_is_null = '{$lang->msg_file_cart_is_null}';
		window.xe.msg_checked_file_is_deleted = '{$lang->msg_checked_file_is_deleted}';
		window.xe.msg_not_allowed_filetype = '{$lang->msg_not_allowed_filetype}';
		window.xe.msg_file_upload_error = '{$lang->msg_file_upload_error}';
		window.xe.cmd_select = '{$lang->cmd_select}';
		window.xe.cmd_select_cover = '{$lang->cmd_select_cover}';

		var setting = {
			maxFileSize: {$file_config->allowed_filesize},
			limitMultiFileUploadSize: {$file_config->allowed_filesize},
			tmplXeUploaderFileitem : '<li class="xefu-file xe-clearfix" data-file-srl="{{file_srl}}"><span class="xefu-file-name">{{source_filename}}</span><span class="xefu-file-info"><span>{{disp_file_size}}</span><span><input type="checkbox" data-file-srl="{{file_srl}}"> Select</span></span></li>',
			tmplXeUploaderFileitemImage: '<li class="xefu-file xefu-file-image {{#if cover_image}}xefu-is-cover-image{{/if}}" data-file-srl="{{file_srl}}"><strong class="xefu-file-name">{{source_filename}}</strong><span class="xefu-file-info"><span class="xefu-file-size">{{disp_file_size}}</span><span><img src="{{download_url}}" alt=""></span><span><input type="checkbox" data-file-srl="{{file_srl}}"></span><button class="xefu-act-set-cover" data-file-srl="{{file_srl}}" title="Be a cover image"><i class="xi-check-circle"></i></button></span></li>'
		};

		if(typeof window.xe.cmd_select != "undefined" && window.xe.cmd_select !== "")
		{
			setting.tmplXeUploaderFileitem = setting.tmplXeUploaderFileitem.replace("Select", window.xe.cmd_select);
		}
		if(typeof window.xe.cmd_select_cover != "undefined" && window.xe.cmd_select_cover !== "")
		{
			setting.tmplXeUploaderFileitemImage = setting.tmplXeUploaderFileitemImage.replace("Be a cover image", window.xe.cmd_select_cover);
		}

		var uploader = $('#xefu-container-{$editor_sequence}').xeUploader(setting);
		<!--@endif-->
	});
</script>
